<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Image to PDF Converter</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: white;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    header {
      background: linear-gradient(to right, #4a6ee0, #2a4cb3);
      color: white;
      padding: 30px;
      text-align: center;
    }

    header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    header p {
      opacity: 0.9;
      font-size: 1.2rem;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .main-content {
      display: flex;
      flex-wrap: wrap;
      padding: 30px;
      gap: 30px;
    }

    .left-panel {
      flex: 1;
      min-width: 300px;
    }

    .right-panel {
      flex: 2;
      min-width: 500px;
    }

    .upload-section {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 25px;
    }

    .upload-area {
      border: 3px dashed #4a6ee0;
      border-radius: 12px;
      padding: 50px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background-color: white;
    }

    .upload-area:hover {
      background-color: #f0f5ff;
      border-color: #2a4cb3;
      transform: translateY(-5px);
    }

    .upload-area i {
      font-size: 4rem;
      color: #4a6ee0;
      margin-bottom: 20px;
    }

    .upload-area h3 {
      margin-bottom: 15px;
      color: #333;
      font-size: 1.5rem;
    }

    .upload-area p {
      color: #666;
      margin-bottom: 10px;
    }

    #image-upload {
      display: none;
    }

    .file-input-btn {
      background: linear-gradient(to right, #4a6ee0, #2a4cb3);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 15px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s;
    }

    .file-input-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 7px 15px rgba(74, 110, 224, 0.3);
    }

    .controls-section {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .section-title {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      color: #2a4cb3;
      font-size: 1.3rem;
      gap: 10px;
    }

    .section-title i {
      font-size: 1.5rem;
    }

    .control-group {
      margin-bottom: 25px;
    }

    .control-group h4 {
      margin-bottom: 15px;
      color: #333;
      padding-bottom: 8px;
      border-bottom: 1px solid #e0e0e0;
    }

    .control-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }

    .option-btn {
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px 10px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .option-btn:hover {
      border-color: #4a6ee0;
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    }

    .option-btn.active {
      border-color: #4a6ee0;
      background-color: #f0f5ff;
    }

    .option-btn i {
      font-size: 1.5rem;
      color: #4a6ee0;
    }

    .range-control {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-top: 10px;
    }

    .range-control input {
      flex: 1;
    }

    .range-value {
      min-width: 50px;
      text-align: center;
      font-weight: bold;
      color: #2a4cb3;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 15px 0;
    }

    .checkbox-group input {
      width: 18px;
      height: 18px;
    }

    .preview-section {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      height: 100%;
    }

    .preview-container {
      border: 1px solid #ddd;
      border-radius: 10px;
      overflow: auto;
      background: white;
      min-height: 400px;
      max-height: 500px;
      padding: 20px;
      margin-bottom: 25px;
    }

    .images-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }

    .image-item {
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
    }

    .image-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }

    .image-item img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      display: block;
    }

    .image-item .remove-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .image-item:hover .remove-btn {
      opacity: 1;
    }

    .image-item .page-num {
      position: absolute;
      bottom: 5px;
      left: 5px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
    }

    .empty-preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 300px;
      color: #888;
      text-align: center;
    }

    .empty-preview i {
      font-size: 4rem;
      margin-bottom: 20px;
      color: #ccc;
    }

    .file-info {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #e0e0e0;
    }

    .info-item {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #555;
    }

    .info-item i {
      color: #4a6ee0;
    }

    .action-section {
      padding: 25px 30px;
      background: #f8f9fa;
      border-top: 1px solid #e0e0e0;
      display: flex;
      justify-content: center;
      gap: 20px;
    }

    .action-btn {
      padding: 15px 35px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s;
    }

    #convert-btn {
      background: linear-gradient(to right, #28a745, #1e7e34);
      color: white;
    }

    #convert-btn:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3);
    }

    #convert-btn:disabled {
      background: #6c757d;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    #clear-btn {
      background: #6c757d;
      color: white;
    }

    #clear-btn:hover {
      background: #5a6268;
      transform: translateY(-5px);
    }

    .notification {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background-color: #28a745;
      color: white;
      padding: 18px 25px;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      display: none;
      z-index: 1000;
      max-width: 350px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @media (max-width: 900px) {
      .main-content {
        flex-direction: column;
      }
      
      .left-panel, .right-panel {
        min-width: 100%;
      }
    }

    @media (max-width: 600px) {
      .control-options {
        grid-template-columns: 1fr;
      }
      
      .action-section {
        flex-direction: column;
      }
      
      .action-btn {
        width: 100%;
        justify-content: center;
      }
      
      header h1 {
        font-size: 2rem;
      }
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #4a6ee0;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-file-pdf"></i> Image to PDF Converter</h1>
      <p>Convert multiple images to a single PDF document with customizable page settings, margins, and orientation. Perfect for creating digital documents, portfolios, and presentations.</p>
    </header>

    <div class="main-content">
      <div class="left-panel">
        <div class="upload-section">
          <div class="upload-area" id="upload-area">
            <i class="fas fa-cloud-upload-alt"></i>
            <h3>Upload Your Images</h3>
            <p>Click to browse or drag and drop your images here</p>
            <p>Supports: JPG, PNG, GIF, WEBP, BMP</p>
            <button class="file-input-btn" id="upload-btn">
              <i class="fas fa-folder-open"></i> Select Images
            </button>
            <input type="file" id="image-upload" accept="image/*" multiple>
          </div>
        </div>

        <div class="controls-section">
          <div class="section-title">
            <i class="fas fa-sliders-h"></i>
            <h3>PDF Settings</h3>
          </div>
          
          <div class="control-group">
            <h4>Page Size</h4>
            <div class="control-options">
              <div class="option-btn active" data-size="a4">
                <i class="fas fa-file-alt"></i>
                <span>A4 (210×297mm)</span>
              </div>
              <div class="option-btn" data-size="letter">
                <i class="fas fa-file-alt"></i>
                <span>Letter (8.5×11in)</span>
              </div>
              <div class="option-btn" data-size="legal">
                <i class="fas fa-file-alt"></i>
                <span>Legal (8.5×14in)</span>
              </div>
              <div class="option-btn" data-size="a5">
                <i class="fas fa-file-alt"></i>
                <span>A5 (148×210mm)</span>
              </div>
            </div>
          </div>
          
          <div class="control-group">
            <h4>Page Orientation</h4>
            <div class="control-options">
              <div class="option-btn active" data-orientation="portrait">
                <i class="fas fa-arrows-alt-v"></i>
                <span>Portrait</span>
              </div>
              <div class="option-btn" data-orientation="landscape">
                <i class="fas fa-arrows-alt-h"></i>
                <span>Landscape</span>
              </div>
            </div>
          </div>
          
          <div class="control-group">
            <h4>Image Fit</h4>
            <div class="control-options">
              <div class="option-btn active" data-fit="fit">
                <i class="fas fa-expand-alt"></i>
                <span>Fit to Page</span>
              </div>
              <div class="option-btn" data-fit="fill">
                <i class="fas fa-expand"></i>
                <span>Fill Page</span>
              </div>
              <div class="option-btn" data-fit="stretch">
                <i class="fas fa-arrows-alt"></i>
                <span>Stretch</span>
              </div>
            </div>
          </div>
          
          <div class="control-group">
            <h4>Page Margin</h4>
            <div class="range-control">
              <span>Small</span>
              <input type="range" id="margin-slider" min="0" max="50" value="10" step="5">
              <span>Large</span>
              <span class="range-value" id="margin-value">10 mm</span>
            </div>
          </div>
          
          <div class="checkbox-group">
            <input type="checkbox" id="add-page-numbers" checked>
            <label for="add-page-numbers">Add page numbers to PDF</label>
          </div>
          
          <div class="checkbox-group">
            <input type="checkbox" id="add-timestamp" checked>
            <label for="add-timestamp">Add creation timestamp</label>
          </div>
        </div>
      </div>

      <div class="right-panel">
        <div class="preview-section">
          <div class="section-title">
            <i class="fas fa-images"></i>
            <h3>Image Preview & Order</h3>
          </div>
          
          <div class="preview-container" id="preview-container">
            <div class="empty-preview" id="empty-preview">
              <i class="fas fa-images"></i>
              <h3>No Images Uploaded</h3>
              <p>Upload images to see preview here</p>
              <p>You can reorder images by dragging and dropping</p>
            </div>
            
            <div class="images-list" id="images-list">
              <!-- Images will be added here dynamically -->
            </div>
          </div>
          
          <div class="file-info">
            <div class="info-item">
              <i class="fas fa-images"></i>
              <span id="image-count">Images: 0</span>
            </div>
            <div class="info-item">
              <i class="fas fa-file-pdf"></i>
              <span id="pdf-size">Estimated PDF Size: -</span>
            </div>
            <div class="info-item">
              <i class="fas fa-sort-numeric-up"></i>
              <span id="page-count">Pages: 0</span>
            </div>
          </div>
        </div>
        
        <div class="loading" id="loading">
          <div class="loading-spinner"></div>
          <p>Creating PDF document...</p>
          <p>This may take a moment depending on the number of images</p>
        </div>
      </div>
    </div>

    <div class="action-section">
      <button class="action-btn" id="convert-btn" disabled>
        <i class="fas fa-file-pdf"></i> Convert to PDF
      </button>
      <button class="action-btn" id="clear-btn">
        <i class="fas fa-trash-alt"></i> Clear All Images
      </button>
    </div>
  </div>

  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i> PDF created successfully!
  </div>

  <!-- Include jsPDF library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <script>
    // Initialize jsPDF
    const { jsPDF } = window.jspdf;
    
    // DOM Elements
    const uploadArea = document.getElementById('upload-area');
    const imageUpload = document.getElementById('image-upload');
    const uploadBtn = document.getElementById('upload-btn');
    const previewContainer = document.getElementById('preview-container');
    const imagesList = document.getElementById('images-list');
    const emptyPreview = document.getElementById('empty-preview');
    const convertBtn = document.getElementById('convert-btn');
    const clearBtn = document.getElementById('clear-btn');
    const notification = document.getElementById('notification');
    const loading = document.getElementById('loading');
    
    // Info elements
    const imageCount = document.getElementById('image-count');
    const pdfSize = document.getElementById('pdf-size');
    const pageCount = document.getElementById('page-count');
    
    // Control elements
    const marginSlider = document.getElementById('margin-slider');
    const marginValue = document.getElementById('margin-value');
    const addPageNumbers = document.getElementById('add-page-numbers');
    const addTimestamp = document.getElementById('add-timestamp');
    
    // State variables
    let images = [];
    let pageSize = 'a4';
    let orientation = 'portrait';
    let imageFit = 'fit';
    let margin = 10; // in mm
    
    // Page size definitions (in mm)
    const pageSizes = {
      a4: { width: 210, height: 297 },
      letter: { width: 215.9, height: 279.4 },
      legal: { width: 215.9, height: 355.6 },
      a5: { width: 148, height: 210 }
    };

    // Event Listeners
    uploadArea.addEventListener('click', () => imageUpload.click());
    uploadBtn.addEventListener('click', () => imageUpload.click());
    
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.style.backgroundColor = '#f0f5ff';
      uploadArea.style.borderColor = '#2a4cb3';
    });
    
    uploadArea.addEventListener('dragleave', () => {
      uploadArea.style.backgroundColor = 'white';
      uploadArea.style.borderColor = '#4a6ee0';
    });
    
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.style.backgroundColor = 'white';
      uploadArea.style.borderColor = '#4a6ee0';
      
      if (e.dataTransfer.files.length) {
        handleImageUpload(Array.from(e.dataTransfer.files));
      }
    });

    imageUpload.addEventListener('change', (event) => {
      handleImageUpload(Array.from(event.target.files));
    });

    clearBtn.addEventListener('click', clearAllImages);
    
    convertBtn.addEventListener('click', convertToPDF);
    
    marginSlider.addEventListener('input', () => {
      margin = parseInt(marginSlider.value);
      marginValue.textContent = `${margin} mm`;
      updatePDFInfo();
    });

    // Setup option buttons
    document.querySelectorAll('.option-btn[data-size]').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.option-btn[data-size]').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        pageSize = this.getAttribute('data-size');
        updatePDFInfo();
      });
    });

    document.querySelectorAll('.option-btn[data-orientation]').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.option-btn[data-orientation]').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        orientation = this.getAttribute('data-orientation');
        updatePDFInfo();
      });
    });

    document.querySelectorAll('.option-btn[data-fit]').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.option-btn[data-fit]').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        imageFit = this.getAttribute('data-fit');
      });
    });

    // Initialize margin display
    marginValue.textContent = `${margin} mm`;

    // Functions
    function handleImageUpload(files) {
      const validFiles = Array.from(files).filter(file => 
        file.type.startsWith('image/')
      );
      
      if (validFiles.length === 0) {
        showNotification('No valid image files selected', 'error');
        return;
      }
      
      // Limit to 20 images for performance
      if (validFiles.length > 20) {
        showNotification('Maximum 20 images allowed. First 20 will be used.', 'warning');
        validFiles.splice(20);
      }
      
      // Process each file
      validFiles.forEach((file, index) => {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          const img = new Image();
          
          img.onload = function() {
            addImage({
              id: Date.now() + index,
              name: file.name,
              size: file.size,
              url: e.target.result,
              width: img.width,
              height: img.height
            });
          };
          
          img.src = e.target.result;
        };
        
        reader.readAsDataURL(file);
      });
      
      // Reset file input to allow uploading same files again
      imageUpload.value = '';
    }

    function addImage(imageData) {
      images.push(imageData);
      renderImagesList();
      updatePDFInfo();
      convertBtn.disabled = false;
    }

    function removeImage(id) {
      images = images.filter(img => img.id !== id);
      renderImagesList();
      updatePDFInfo();
      if (images.length === 0) {
        convertBtn.disabled = true;
      }
    }

    function clearAllImages() {
      if (images.length === 0) return;
      
      if (confirm('Are you sure you want to remove all images?')) {
        images = [];
        renderImagesList();
        updatePDFInfo();
        convertBtn.disabled = true;
        showNotification('All images cleared', 'info');
      }
    }

    function renderImagesList() {
      if (images.length === 0) {
        emptyPreview.style.display = 'flex';
        imagesList.innerHTML = '';
        return;
      }
      
      emptyPreview.style.display = 'none';
      
      imagesList.innerHTML = images.map((img, index) => `
        <div class="image-item" data-id="${img.id}" draggable="true">
          <img src="${img.url}" alt="${img.name}">
          <button class="remove-btn" onclick="removeImage(${img.id})">
            <i class="fas fa-times"></i>
          </button>
          <div class="page-num">Page ${index + 1}</div>
        </div>
      `).join('');
      
      // Add drag and drop functionality
      setupDragAndDrop();
    }

    function setupDragAndDrop() {
      const imageItems = document.querySelectorAll('.image-item');
      
      imageItems.forEach(item => {
        item.addEventListener('dragstart', handleDragStart);
        item.addEventListener('dragover', handleDragOver);
        item.addEventListener('drop', handleDrop);
        item.addEventListener('dragend', handleDragEnd);
      });
    }
    
    let draggedItem = null;
    
    function handleDragStart(e) {
      draggedItem = this;
      this.style.opacity = '0.5';
      e.dataTransfer.effectAllowed = 'move';
    }
    
    function handleDragOver(e) {
      e.preventDefault();
      return false;
    }
    
    function handleDrop(e) {
      e.stopPropagation();
      
      if (draggedItem !== this) {
        const draggedId = parseInt(draggedItem.getAttribute('data-id'));
        const targetId = parseInt(this.getAttribute('data-id'));
        
        const draggedIndex = images.findIndex(img => img.id === draggedId);
        const targetIndex = images.findIndex(img => img.id === targetId);
        
        // Reorder images array
        const [draggedImage] = images.splice(draggedIndex, 1);
        images.splice(targetIndex, 0, draggedImage);
        
        renderImagesList();
        showNotification('Image order updated', 'success');
      }
      
      return false;
    }
    
    function handleDragEnd(e) {
      this.style.opacity = '1';
    }

    function updatePDFInfo() {
      imageCount.textContent = `Images: ${images.length}`;
      pageCount.textContent = `Pages: ${images.length}`;
      
      // Estimate PDF size (rough calculation)
      const totalImageSize = images.reduce((sum, img) => sum + img.size, 0);
      const estimatedPDFSize = totalImageSize * 0.7; // PDF is typically smaller
      
      if (images.length > 0) {
        pdfSize.textContent = `Estimated PDF Size: ${formatFileSize(estimatedPDFSize)}`;
      } else {
        pdfSize.textContent = 'Estimated PDF Size: -';
      }
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' bytes';
      else if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';
      else return (bytes / 1048576).toFixed(2) + ' MB';
    }

    async function convertToPDF() {
      if (images.length === 0) return;
      
      // Show loading
      loading.style.display = 'block';
      convertBtn.disabled = true;
      
      try {
        // Get page dimensions
        const pageDimensions = pageSizes[pageSize];
        const isLandscape = orientation === 'landscape';
        const pageWidth = isLandscape ? pageDimensions.height : pageDimensions.width;
        const pageHeight = isLandscape ? pageDimensions.width : pageDimensions.height;
        
        // Create PDF document
        const pdf = new jsPDF({
          orientation: orientation,
          unit: 'mm',
          format: pageSize
        });
        
        // Add creation date if enabled
        if (addTimestamp.checked) {
          const now = new Date();
          const dateStr = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
          pdf.setProperties({
            title: 'Converted Images PDF',
            subject: 'Images converted to PDF',
            creator: 'Image to PDF Converter',
            creationDate: now
          });
        }
        
        // Process each image
        for (let i = 0; i < images.length; i++) {
          const img = images[i];
          
          // Add new page for all images except the first
          if (i > 0) {
            pdf.addPage();
          }
          
          // Calculate image positioning and dimensions
          const availableWidth = pageWidth - (2 * margin);
          const availableHeight = pageHeight - (2 * margin);
          
          let imgWidth, imgHeight;
          
          // Calculate dimensions based on fit mode
          if (imageFit === 'stretch') {
            imgWidth = availableWidth;
            imgHeight = availableHeight;
          } else {
            const imgRatio = img.width / img.height;
            const availableRatio = availableWidth / availableHeight;
            
            if (imageFit === 'fill') {
              // Fill mode: cover the entire area, cropping if needed
              if (imgRatio > availableRatio) {
                imgHeight = availableHeight;
                imgWidth = imgHeight * imgRatio;
              } else {
                imgWidth = availableWidth;
                imgHeight = imgWidth / imgRatio;
              }
            } else {
              // Fit mode: fit entirely within the area
              if (imgRatio > availableRatio) {
                imgWidth = availableWidth;
                imgHeight = imgWidth / imgRatio;
              } else {
                imgHeight = availableHeight;
                imgWidth = imgHeight * imgRatio;
              }
            }
          }
          
          // Center the image
          const x = margin + (availableWidth - imgWidth) / 2;
          const y = margin + (availableHeight - imgHeight) / 2;
          
          // Add image to PDF
          pdf.addImage(img.url, 'JPEG', x, y, imgWidth, imgHeight);
          
          // Add page number if enabled
          if (addPageNumbers.checked) {
            const pageNum = i + 1;
            pdf.setFontSize(10);
            pdf.setTextColor(100, 100, 100);
            pdf.text(
              `Page ${pageNum} of ${images.length}`,
              pageWidth / 2,
              pageHeight - 5,
              { align: 'center' }
            );
          }
        }
        
        // Generate PDF and trigger download
        const pdfName = `images_converted_${Date.now()}.pdf`;
        pdf.save(pdfName);
        
        // Show success notification
        showNotification('PDF created successfully! Download started.', 'success');
        
      } catch (error) {
        console.error('Error creating PDF:', error);
        showNotification('Error creating PDF. Please try again.', 'error');
      } finally {
        // Hide loading
        loading.style.display = 'none';
        convertBtn.disabled = false;
      }
    }

    function showNotification(message, type = 'success') {
      // Set notification color based on type
      let bgColor;
      switch(type) {
        case 'success':
          bgColor = '#28a745';
          break;
        case 'error':
          bgColor = '#dc3545';
          break;
        case 'warning':
          bgColor = '#ffc107';
          break;
        case 'info':
          bgColor = '#17a2b8';
          break;
        default:
          bgColor = '#28a745';
      }
      
      notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i> ${message}`;
      notification.style.backgroundColor = bgColor;
      notification.style.display = 'block';
      
      // Auto hide after 4 seconds
      setTimeout(() => {
        notification.style.display = 'none';
      }, 4000);
    }

    // Initialize
    updatePDFInfo();
  </script>
</body>
</html>