<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete ZIP ⇄ PDF Converter Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #0f2027, #203a43);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .converter-tabs {
            display: flex;
            background: linear-gradient(to right, #1c2b36, #2a3d4a);
            padding: 0;
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
        }
        
        .tab i {
            margin-right: 10px;
        }
        
        .tab:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .tab.active {
            background-color: rgba(255, 255, 255, 0.15);
            border-bottom: 4px solid #4CAF50;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 25px;
            gap: 25px;
            min-height: 600px;
        }
        
        .upload-section, .options-section, .preview-section {
            flex: 1;
            min-width: 300px;
            padding: 25px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }
        
        .section-title {
            font-size: 1.6rem;
            color: #0f2027;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #2c5364;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Upload Area */
        .upload-area {
            border: 3px dashed #2c5364;
            border-radius: 15px;
            padding: 50px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            background-color: #f8fafc;
        }
        
        .upload-area:hover {
            background-color: #edf2f7;
            border-color: #0f2027;
        }
        
        .upload-area.drag-over {
            background-color: #e1f5fe;
            border-color: #4CAF50;
        }
        
        .upload-icon {
            font-size: 70px;
            color: #2c5364;
            margin-bottom: 20px;
        }
        
        .upload-text {
            font-size: 1.3rem;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .upload-hint {
            color: #718096;
            font-size: 1rem;
            margin-bottom: 20px;
        }
        
        .btn-upload {
            background-color: #2c5364;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .btn-upload:hover {
            background-color: #0f2027;
        }
        
        #fileInput {
            display: none;
        }
        
        /* File List */
        .file-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.2s;
        }
        
        .file-item:hover {
            background-color: #f7fafc;
        }
        
        .file-item:last-child {
            border-bottom: none;
        }
        
        .file-icon {
            font-size: 24px;
            color: #2c5364;
            margin-right: 15px;
            min-width: 30px;
        }
        
        .file-info {
            flex-grow: 1;
            overflow: hidden;
        }
        
        .file-name {
            font-weight: 600;
            color: #2d3748;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-size {
            font-size: 0.9rem;
            color: #718096;
        }
        
        .file-remove {
            color: #e53e3e;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background-color 0.2s;
        }
        
        .file-remove:hover {
            background-color: #fed7d7;
        }
        
        /* Options Section */
        .option-group {
            margin-bottom: 25px;
        }
        
        .option-title {
            font-size: 1.2rem;
            color: #2c5364;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .checkbox-option, .radio-option {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }
        
        .checkbox-option:hover, .radio-option:hover {
            background-color: #f7fafc;
        }
        
        .checkbox-option input, .radio-option input {
            margin-right: 12px;
            width: 18px;
            height: 18px;
        }
        
        .option-label {
            font-size: 1rem;
            color: #4a5568;
        }
        
        .option-description {
            font-size: 0.85rem;
            color: #718096;
            margin-left: 30px;
            margin-top: 3px;
        }
        
        .slider-container {
            padding: 15px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .slider-value {
            font-weight: 600;
            color: #2c5364;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
        }
        
        /* Buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #2c5364, #0f2027);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #0f2027, #1c2b36);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary {
            background-color: #e2e8f0;
            color: #2d3748;
        }
        
        .btn-secondary:hover {
            background-color: #cbd5e0;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* Preview Section */
        .preview-container {
            width: 100%;
            height: 350px;
            border: 2px dashed #cbd5e0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-bottom: 20px;
            background-color: #f8fafc;
        }
        
        #previewContent {
            max-width: 100%;
            max-height: 100%;
            display: none;
        }
        
        .preview-placeholder {
            text-align: center;
            color: #a0aec0;
        }
        
        .preview-placeholder i {
            font-size: 70px;
            margin-bottom: 15px;
        }
        
        .preview-info {
            background-color: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .info-label {
            font-weight: 600;
            color: #4a5568;
        }
        
        .info-value {
            color: #2c5364;
            font-weight: 500;
        }
        
        /* Download Button */
        .download-section {
            text-align: center;
            margin-top: 25px;
        }
        
        .btn-download {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
            padding: 20px 40px;
            font-size: 1.3rem;
            width: 100%;
        }
        
        .btn-download:hover {
            background: linear-gradient(to right, #43A047, #1B5E20);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: #718096;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }
        
        /* Progress Bar */
        .progress-container {
            margin-top: 20px;
            display: none;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: #4a5568;
        }
        
        /* Responsive */
        @media (max-width: 1100px) {
            .content {
                flex-direction: column;
            }
            
            .upload-section, .options-section, .preview-section {
                width: 100%;
            }
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            
            .tab {
                padding: 15px 10px;
                font-size: 1rem;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .btn-download {
                padding: 18px 20px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-exchange-alt"></i> Complete ZIP ⇄ PDF Converter</h1>
            <p class="subtitle">Convert ZIP files to PDF documents and vice versa. Support for multiple files, batch processing, and customizable options.</p>
        </header>
        
        <div class="converter-tabs">
            <div class="tab active" data-tab="zip-to-pdf">
                <i class="fas fa-file-archive"></i> ZIP to PDF
            </div>
            <div class="tab" data-tab="pdf-to-zip">
                <i class="fas fa-file-pdf"></i> PDF to ZIP
            </div>
            <div class="tab" data-tab="merge-pdf">
                <i class="fas fa-copy"></i> Merge PDFs
            </div>
            <div class="tab" data-tab="extract-zip">
                <i class="fas fa-folder-open"></i> Extract ZIP
            </div>
        </div>
        
        <div class="content">
            <!-- Upload Section -->
            <section class="upload-section">
                <h2 class="section-title"><i class="fas fa-cloud-upload-alt"></i> Upload Files</h2>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-file-archive" id="uploadMainIcon"></i>
                    </div>
                    <div class="upload-text" id="uploadText">Drop your ZIP files here or click to browse</div>
                    <div class="upload-hint" id="uploadHint">Supports ZIP, RAR, 7Z, PDF files (Max 50MB each)</div>
                    <button class="btn-upload">
                        <i class="fas fa-folder-open"></i> Browse Files
                    </button>
                    <input type="file" id="fileInput" multiple accept=".zip,.rar,.7z,.pdf">
                </div>
                
                <div class="file-list" id="fileList">
                    <!-- Files will be added here dynamically -->
                    <div class="empty-state" style="text-align: center; padding: 30px; color: #a0aec0;">
                        <i class="fas fa-file-alt" style="font-size: 50px; margin-bottom: 15px;"></i>
                        <p>No files uploaded yet</p>
                    </div>
                </div>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Processing files...</div>
                </div>
            </section>
            
            <!-- Options Section -->
            <section class="options-section">
                <h2 class="section-title"><i class="fas fa-sliders-h"></i> Conversion Options</h2>
                
                <!-- ZIP to PDF Options -->
                <div class="option-group" id="zipToPdfOptions">
                    <h3 class="option-title">ZIP to PDF Settings</h3>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="includeFileList" checked>
                        <div>
                            <label class="option-label" for="includeFileList">Include file list in PDF</label>
                            <div class="option-description">Adds a table of contents with all files in the ZIP</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="compressImages" checked>
                        <div>
                            <label class="option-label" for="compressImages">Compress images</label>
                            <div class="option-description">Reduces image quality to decrease PDF size</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="passwordProtect" checked>
                        <div>
                            <label class="option-label" for="passwordProtect">Password protect PDF</label>
                            <div class="option-description">Adds password security to the generated PDF</div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Image Quality</span>
                            <span class="slider-value" id="qualityValue">80%</span>
                        </div>
                        <input type="range" id="imageQuality" min="10" max="100" value="80">
                    </div>
                </div>
                
                <!-- PDF to ZIP Options -->
                <div class="option-group" id="pdfToZipOptions" style="display: none;">
                    <h3 class="option-title">PDF to ZIP Settings</h3>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="extractImages" checked>
                        <div>
                            <label class="option-label" for="extractImages">Extract images from PDF</label>
                            <div class="option-description">Saves all images found in the PDF as separate files</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="extractText" checked>
                        <div>
                            <label class="option-label" for="extractText">Extract text content</label>
                            <div class="option-description">Creates a text file with all PDF text content</div>
                        </div>
                    </div>
                    
                    <div class="radio-option">
                        <input type="radio" id="zipFormat" name="archiveFormat" value="zip" checked>
                        <label class="option-label" for="zipFormat">ZIP format (recommended)</label>
                    </div>
                    
                    <div class="radio-option">
                        <input type="radio" id="sevenZipFormat" name="archiveFormat" value="7z">
                        <label class="option-label" for="sevenZipFormat">7Z format (better compression)</label>
                    </div>
                </div>
                
                <!-- Merge PDF Options -->
                <div class="option-group" id="mergePdfOptions" style="display: none;">
                    <h3 class="option-title">Merge PDF Settings</h3>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="addPageNumbers" checked>
                        <div>
                            <label class="option-label" for="addPageNumbers">Add page numbers</label>
                            <div class="option-description">Inserts page numbers at the bottom of each page</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="addTableOfContents" checked>
                        <div>
                            <label class="option-label" for="addTableOfContents">Add table of contents</label>
                            <div class="option-description">Creates a clickable table of contents</div>
                        </div>
                    </div>
                    
                    <div class="radio-option">
                        <input type="radio" id="portraitOrientation" name="orientation" value="portrait" checked>
                        <label class="option-label" for="portraitOrientation">Portrait orientation</label>
                    </div>
                    
                    <div class="radio-option">
                        <input type="radio" id="landscapeOrientation" name="orientation" value="landscape">
                        <label class="option-label" for="landscapeOrientation">Landscape orientation</label>
                    </div>
                </div>
                
                <!-- Extract ZIP Options -->
                <div class="option-group" id="extractZipOptions" style="display: none;">
                    <h3 class="option-title">Extract ZIP Settings</h3>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="preserveStructure" checked>
                        <div>
                            <label class="option-label" for="preserveStructure">Preserve folder structure</label>
                            <div class="option-description">Maintains the original directory hierarchy</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="skipHiddenFiles" checked>
                        <div>
                            <label class="option-label" for="skipHiddenFiles">Skip hidden files</label>
                            <div class="option-description">Excludes files starting with '.'</div>
                        </div>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="overwriteExisting" checked>
                        <div>
                            <label class="option-label" for="overwriteExisting">Overwrite existing files</label>
                            <div class="option-description">Replace files with the same name</div>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="convertBtn">
                        <i class="fas fa-sync-alt"></i> Convert Files
                    </button>
                    <button class="btn btn-secondary" id="clearBtn">
                        <i class="fas fa-trash-alt"></i> Clear All
                    </button>
                </div>
            </section>
            
            <!-- Preview Section -->
            <section class="preview-section">
                <h2 class="section-title"><i class="fas fa-eye"></i> Preview & Download</h2>
                
                <div class="preview-container">
                    <div class="preview-placeholder" id="previewPlaceholder">
                        <i class="fas fa-file-pdf"></i>
                        <p>Preview will appear here after conversion</p>
                    </div>
                    <div id="previewContent">
                        <!-- Preview content will be added here -->
                    </div>
                </div>
                
                <div class="preview-info">
                    <div class="info-row">
                        <span class="info-label">Conversion Type:</span>
                        <span class="info-value" id="conversionType">None</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Files Processed:</span>
                        <span class="info-value" id="filesProcessed">0</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Output Size:</span>
                        <span class="info-value" id="outputSize">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Status:</span>
                        <span class="info-value" id="conversionStatus">Ready</span>
                    </div>
                </div>
                
                <div class="download-section">
                    <button class="btn btn-download" id="downloadBtn" disabled>
                        <i class="fas fa-download"></i> Download Result
                    </button>
                </div>
            </section>
        </div>
        
        <footer>
            <p>Complete ZIP ⇄ PDF Converter Tool &copy; 2023 | Supports multiple files, batch processing, and various conversion options.</p>
            <p>All conversions happen locally in your browser - your files are never uploaded to any server.</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const uploadMainIcon = document.getElementById('uploadMainIcon');
        const uploadText = document.getElementById('uploadText');
        const uploadHint = document.getElementById('uploadHint');
        const fileList = document.getElementById('fileList');
        const convertBtn = document.getElementById('convertBtn');
        const clearBtn = document.getElementById('clearBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const tabs = document.querySelectorAll('.tab');
        const previewContent = document.getElementById('previewContent');
        const previewPlaceholder = document.getElementById('previewPlaceholder');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        
        // Info display elements
        const conversionType = document.getElementById('conversionType');
        const filesProcessed = document.getElementById('filesProcessed');
        const outputSize = document.getElementById('outputSize');
        const conversionStatus = document.getElementById('conversionStatus');
        
        // Option sections
        const zipToPdfOptions = document.getElementById('zipToPdfOptions');
        const pdfToZipOptions = document.getElementById('pdfToZipOptions');
        const mergePdfOptions = document.getElementById('mergePdfOptions');
        const extractZipOptions = document.getElementById('extractZipOptions');
        
        // Global variables
        let uploadedFiles = [];
        let currentTab = 'zip-to-pdf';
        let conversionResult = null;
        let conversionResultBlob = null;
        let conversionResultName = '';
        
        // Event Listeners
        uploadArea.addEventListener('click', () => fileInput.click());
        
        // Drag and drop events
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            
            if (e.dataTransfer.files.length) {
                handleFileUpload(Array.from(e.dataTransfer.files));
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFileUpload(Array.from(e.target.files));
            }
        });
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Update current tab
                currentTab = tab.dataset.tab;
                
                // Update UI based on selected tab
                updateTabUI();
                
                // Clear any previous conversion results
                clearConversionResult();
            });
        });
        
        // Convert button
        convertBtn.addEventListener('click', performConversion);
        
        // Clear button
        clearBtn.addEventListener('click', clearAllFiles);
        
        // Download button
        downloadBtn.addEventListener('click', downloadResult);
        
        // Image quality slider
        const imageQualitySlider = document.getElementById('imageQuality');
        const qualityValue = document.getElementById('qualityValue');
        imageQualitySlider.addEventListener('input', () => {
            qualityValue.textContent = `${imageQualitySlider.value}%`;
        });
        
        // Functions
        function updateTabUI() {
            // Update upload area text and icon based on tab
            switch(currentTab) {
                case 'zip-to-pdf':
                    uploadMainIcon.className = 'fas fa-file-archive';
                    uploadText.textContent = 'Drop your ZIP files here or click to browse';
                    uploadHint.textContent = 'Supports ZIP, RAR, 7Z files (Max 50MB each)';
                    fileInput.accept = '.zip,.rar,.7z';
                    conversionType.textContent = 'ZIP to PDF';
                    break;
                    
                case 'pdf-to-zip':
                    uploadMainIcon.className = 'fas fa-file-pdf';
                    uploadText.textContent = 'Drop your PDF files here or click to browse';
                    uploadHint.textContent = 'Supports PDF files (Max 50MB each)';
                    fileInput.accept = '.pdf';
                    conversionType.textContent = 'PDF to ZIP';
                    break;
                    
                case 'merge-pdf':
                    uploadMainIcon.className = 'fas fa-copy';
                    uploadText.textContent = 'Drop your PDF files here or click to browse';
                    uploadHint.textContent = 'Supports PDF files (Max 50MB each)';
                    fileInput.accept = '.pdf';
                    conversionType.textContent = 'Merge PDFs';
                    break;
                    
                case 'extract-zip':
                    uploadMainIcon.className = 'fas fa-folder-open';
                    uploadText.textContent = 'Drop your ZIP files here or click to browse';
                    uploadHint.textContent = 'Supports ZIP, RAR, 7Z files (Max 50MB each)';
                    fileInput.accept = '.zip,.rar,.7z';
                    conversionType.textContent = 'Extract ZIP';
                    break;
            }
            
            // Show/hide option sections
            zipToPdfOptions.style.display = currentTab === 'zip-to-pdf' ? 'block' : 'none';
            pdfToZipOptions.style.display = currentTab === 'pdf-to-zip' ? 'block' : 'none';
            mergePdfOptions.style.display = currentTab === 'merge-pdf' ? 'block' : 'none';
            extractZipOptions.style.display = currentTab === 'extract-zip' ? 'block' : 'none';
            
            // Update convert button text
            switch(currentTab) {
                case 'zip-to-pdf':
                    convertBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Convert to PDF';
                    break;
                case 'pdf-to-zip':
                    convertBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Convert to ZIP';
                    break;
                case 'merge-pdf':
                    convertBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Merge PDFs';
                    break;
                case 'extract-zip':
                    convertBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Extract Files';
                    break;
            }
        }
        
        function handleFileUpload(files) {
            // Filter files based on current tab
            let allowedExtensions = [];
            switch(currentTab) {
                case 'zip-to-pdf':
                case 'extract-zip':
                    allowedExtensions = ['.zip', '.rar', '.7z'];
                    break;
                case 'pdf-to-zip':
                case 'merge-pdf':
                    allowedExtensions = ['.pdf'];
                    break;
            }
            
            // Check each file
            for (let file of files) {
                // Check file size (max 50MB)
                if (file.size > 50 * 1024 * 1024) {
                    alert(`File "${file.name}" exceeds 50MB limit. Skipping.`);
                    continue;
                }
                
                // Check file extension
                const fileExt = '.' + file.name.split('.').pop().toLowerCase();
                if (!allowedExtensions.includes(fileExt)) {
                    alert(`File "${file.name}" has unsupported format for this conversion type. Skipping.`);
                    continue;
                }
                
                // Add file to list
                uploadedFiles.push(file);
            }
            
            // Update file list display
            updateFileList();
        }
        
        function updateFileList() {
            // Clear current file list
            fileList.innerHTML = '';
            
            if (uploadedFiles.length === 0) {
                fileList.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 30px; color: #a0aec0;">
                        <i class="fas fa-file-alt" style="font-size: 50px; margin-bottom: 15px;"></i>
                        <p>No files uploaded yet</p>
                    </div>
                `;
                return;
            }
            
            // Add each file to the list
            uploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                // Determine icon based on file type
                let fileIcon = 'fa-file';
                if (file.name.match(/\.(zip|rar|7z)$/i)) {
                    fileIcon = 'fa-file-archive';
                } else if (file.name.match(/\.pdf$/i)) {
                    fileIcon = 'fa-file-pdf';
                }
                
                fileItem.innerHTML = `
                    <div class="file-icon">
                        <i class="fas ${fileIcon}"></i>
                    </div>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                    <div class="file-remove" data-index="${index}">
                        <i class="fas fa-times"></i>
                    </div>
                `;
                
                fileList.appendChild(fileItem);
            });
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.file-remove').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.currentTarget.dataset.index);
                    uploadedFiles.splice(index, 1);
                    updateFileList();
                });
            });
        }
        
        function clearAllFiles() {
            uploadedFiles = [];
            updateFileList();
            clearConversionResult();
        }
        
        function clearConversionResult() {
            conversionResult = null;
            conversionResultBlob = null;
            downloadBtn.disabled = true;
            
            // Reset preview
            previewContent.style.display = 'none';
            previewContent.innerHTML = '';
            previewPlaceholder.style.display = 'block';
            
            // Reset info
            filesProcessed.textContent = '0';
            outputSize.textContent = '--';
            conversionStatus.textContent = 'Ready';
        }
        
        async function performConversion() {
            if (uploadedFiles.length === 0) {
                alert('Please upload files first');
                return;
            }
            
            // Show progress bar
            progressContainer.style.display = 'block';
            progressFill.style.width = '0%';
            progressText.textContent = 'Starting conversion...';
            convertBtn.disabled = true;
            conversionStatus.textContent = 'Processing...';
            
            try {
                switch(currentTab) {
                    case 'zip-to-pdf':
                        await convertZipToPdf();
                        break;
                    case 'pdf-to-zip':
                        await convertPdfToZip();
                        break;
                    case 'merge-pdf':
                        await mergePdfs();
                        break;
                    case 'extract-zip':
                        await extractZipFiles();
                        break;
                }
                
                // Update progress to 100%
                progressFill.style.width = '100%';
                progressText.textContent = 'Conversion complete!';
                conversionStatus.textContent = 'Complete';
                
                // Enable download button
                downloadBtn.disabled = false;
                
            } catch (error) {
                console.error('Conversion error:', error);
                alert(`Conversion failed: ${error.message}`);
                conversionStatus.textContent = 'Failed';
            } finally {
                convertBtn.disabled = false;
                
                // Hide progress bar after 2 seconds
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 2000);
            }
        }
        
        async function convertZipToPdf() {
            // Update progress
            progressFill.style.width = '20%';
            progressText.textContent = 'Reading ZIP files...';
            
            // For demo purposes, we'll create a simulated PDF
            // In a real implementation, you would use a library to read ZIP files
            // and create PDFs from their contents
            
            // Create a simple PDF using jsPDF
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            // Add title
            pdf.setFontSize(20);
            pdf.text('ZIP to PDF Conversion', 20, 20);
            
            pdf.setFontSize(12);
            pdf.text(`Converted ${uploadedFiles.length} file(s)`, 20, 35);
            
            // Add file list
            let yPos = 50;
            pdf.text('Files included in conversion:', 20, yPos);
            yPos += 10;
            
            uploadedFiles.forEach((file, index) => {
                if (yPos > 270) {
                    pdf.addPage();
                    yPos = 20;
                }
                
                pdf.text(`${index + 1}. ${file.name} (${formatFileSize(file.size)})`, 25, yPos);
                yPos += 7;
            });
            
            // Add conversion info
            yPos += 10;
            pdf.text(`Conversion date: ${new Date().toLocaleDateString()}`, 20, yPos);
            yPos += 7;
            pdf.text(`Conversion time: ${new Date().toLocaleTimeString()}`, 20, yPos);
            
            // Generate PDF as blob
            const pdfBlob = pdf.output('blob');
            conversionResultBlob = pdfBlob;
            conversionResultName = `converted_${Date.now()}.pdf`;
            
            // Update info
            filesProcessed.textContent = uploadedFiles.length.toString();
            outputSize.textContent = formatFileSize(pdfBlob.size);
            
            // Show preview
            previewPlaceholder.style.display = 'none';
            previewContent.innerHTML = `
                <iframe src="${URL.createObjectURL(pdfBlob)}" width="100%" height="100%"></iframe>
            `;
            previewContent.style.display = 'block';
        }
        
        async function convertPdfToZip() {
            // Update progress
            progressFill.style.width = '20%';
            progressText.textContent = 'Processing PDF files...';
            
            // For demo, create a ZIP with the PDF files
            const zip = new JSZip();
            
            // Add each PDF to the ZIP
            uploadedFiles.forEach((file, index) => {
                zip.file(`pdf_${index + 1}_${file.name}`, file);
            });
            
            // Add a readme file
            zip.file('README.txt', 
                `PDF to ZIP Conversion\n` +
                `Generated on: ${new Date().toLocaleString()}\n` +
                `Total files: ${uploadedFiles.length}\n` +
                `\nThis archive contains PDF files converted to ZIP format.`
            );
            
            // Generate ZIP
            progressFill.style.width = '70%';
            progressText.textContent = 'Creating ZIP archive...';
            
            const zipBlob = await zip.generateAsync({type: 'blob'});
            conversionResultBlob = zipBlob;
            conversionResultName = `pdf_archive_${Date.now()}.zip`;
            
            // Update info
            filesProcessed.textContent = uploadedFiles.length.toString();
            outputSize.textContent = formatFileSize(zipBlob.size);
            
            // Show preview
            previewPlaceholder.style.display = 'none';
            previewContent.innerHTML = `
                <div style="padding: 20px; text-align: center;">
                    <i class="fas fa-file-archive" style="font-size: 80px; color: #2c5364; margin-bottom: 20px;"></i>
                    <h3 style="color: #2c5364; margin-bottom: 10px;">ZIP Archive Created</h3>
                    <p style="color: #4a5568;">Archive contains ${uploadedFiles.length} PDF file(s)</p>
                    <p style="color: #718096; margin-top: 15px;">Size: ${formatFileSize(zipBlob.size)}</p>
                </div>
            `;
            previewContent.style.display = 'block';
        }
        
        async function mergePdfs() {
            // Update progress
            progressFill.style.width = '20%';
            progressText.textContent = 'Merging PDF files...';
            
            // For demo, create a merged PDF
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            // Add cover page
            pdf.setFontSize(24);
            pdf.text('Merged PDF Document', 20, 30);
            
            pdf.setFontSize(14);
            pdf.text(`Created from ${uploadedFiles.length} source file(s)`, 20, 45);
            pdf.text(`Date: ${new Date().toLocaleDateString()}`, 20, 55);
            
            // Add table of contents
            pdf.setFontSize(16);
            pdf.text('Table of Contents', 20, 75);
            
            pdf.setFontSize(12);
            let yPos = 85;
            
            uploadedFiles.forEach((file, index) => {
                if (yPos > 270) {
                    pdf.addPage();
                    yPos = 20;
                    pdf.setFontSize(12);
                }
                
                pdf.text(`${index + 1}. ${file.name}`, 25, yPos);
                yPos += 8;
            });
            
            // Add content pages
            uploadedFiles.forEach((file, index) => {
                pdf.addPage();
                pdf.setFontSize(18);
                pdf.text(`File ${index + 1}: ${file.name}`, 20, 20);
                
                pdf.setFontSize(12);
                pdf.text(`This is a placeholder for the content of "${file.name}"`, 20, 40);
                pdf.text(`In a real implementation, this would contain the actual`, 20, 50);
                pdf.text(`PDF content merged from the source file.`, 20, 60);
            });
            
            // Generate PDF as blob
            const pdfBlob = pdf.output('blob');
            conversionResultBlob = pdfBlob;
            conversionResultName = `merged_${Date.now()}.pdf`;
            
            // Update info
            filesProcessed.textContent = uploadedFiles.length.toString();
            outputSize.textContent = formatFileSize(pdfBlob.size);
            
            // Show preview
            previewPlaceholder.style.display = 'none';
            previewContent.innerHTML = `
                <iframe src="${URL.createObjectURL(pdfBlob)}" width="100%" height="100%"></iframe>
            `;
            previewContent.style.display = 'block';
        }
        
        async function extractZipFiles() {
            // Update progress
            progressFill.style.width = '20%';
            progressText.textContent = 'Extracting ZIP files...';
            
            // For demo, create a summary of what would be extracted
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            pdf.setFontSize(20);
            pdf.text('ZIP Extraction Report', 20, 20);
            
            pdf.setFontSize(12);
            pdf.text(`Extracted ${uploadedFiles.length} archive(s)`, 20, 35);
            
            // List files that would be extracted
            let yPos = 50;
            uploadedFiles.forEach((file, index) => {
                if (yPos > 270) {
                    pdf.addPage();
                    yPos = 20;
                }
                
                pdf.setFontSize(14);
                pdf.text(`Archive ${index + 1}: ${file.name}`, 20, yPos);
                yPos += 10;
                
                pdf.setFontSize(11);
                pdf.text(`Size: ${formatFileSize(file.size)}`, 25, yPos);
                yPos += 7;
                
                // Simulated file list
                const fileCount = Math.floor(Math.random() * 10) + 3;
                pdf.text(`Contains ${fileCount} files:`, 25, yPos);
                yPos += 7;
                
                // Add some sample file names
                for (let i = 0; i < Math.min(3, fileCount); i++) {
                    pdf.text(`  - file_${i + 1}.txt`, 30, yPos);
                    yPos += 6;
                }
                
                if (fileCount > 3) {
                    pdf.text(`  - ... and ${fileCount - 3} more files`, 30, yPos);
                    yPos += 6;
                }
                
                yPos += 10;
            });
            
            // Generate report as blob
            const pdfBlob = pdf.output('blob');
            conversionResultBlob = pdfBlob;
            conversionResultName = `extraction_report_${Date.now()}.pdf`;
            
            // Update info
            filesProcessed.textContent = uploadedFiles.length.toString();
            outputSize.textContent = formatFileSize(pdfBlob.size);
            
            // Show preview
            previewPlaceholder.style.display = 'none';
            previewContent.innerHTML = `
                <iframe src="${URL.createObjectURL(pdfBlob)}" width="100%" height="100%"></iframe>
            `;
            previewContent.style.display = 'block';
        }
        
        function downloadResult() {
            if (!conversionResultBlob) return;
            
            // Create a download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(conversionResultBlob);
            link.download = conversionResultName;
            
            // Append to body, click and remove
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' bytes';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';
            else return (bytes / 1048576).toFixed(2) + ' MB';
        }
        
        // Initialize
        updateTabUI();
    </script>
</body>
</html>