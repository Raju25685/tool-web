<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Advanced Image to PNG Converter</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      color: #333;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background-color: white;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    header {
      background: linear-gradient(to right, #2575fc, #6a11cb);
      color: white;
      padding: 30px;
      text-align: center;
    }

    header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    header p {
      opacity: 0.9;
      font-size: 1.2rem;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .main-content {
      display: flex;
      flex-wrap: wrap;
      padding: 30px;
      gap: 30px;
    }

    .upload-section {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
    }

    .upload-area {
      border: 3px dashed #2575fc;
      border-radius: 12px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background-color: white;
      margin-bottom: 20px;
    }

    .upload-area:hover {
      background-color: #f0f5ff;
      border-color: #6a11cb;
      transform: translateY(-5px);
    }

    .upload-area i {
      font-size: 3.5rem;
      color: #2575fc;
      margin-bottom: 20px;
    }

    .upload-area h3 {
      margin-bottom: 15px;
      color: #333;
      font-size: 1.5rem;
    }

    .upload-area p {
      color: #666;
      margin-bottom: 10px;
    }

    #image-upload {
      display: none;
    }

    .upload-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }

    .upload-btn {
      background: linear-gradient(to right, #2575fc, #6a11cb);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s;
    }

    .upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 7px 15px rgba(37, 117, 252, 0.3);
    }

    .info-panel {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .info-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .info-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .info-label {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #555;
    }

    .info-label i {
      color: #2575fc;
      width: 20px;
    }

    .info-value {
      font-weight: 600;
      color: #333;
    }

    .editor-section {
      flex: 2;
      min-width: 500px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
    }

    .preview-container {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 25px;
      text-align: center;
      min-height: 300px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    #image-preview {
      max-width: 100%;
      max-height: 400px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .placeholder {
      color: #888;
      text-align: center;
    }

    .placeholder i {
      font-size: 4rem;
      margin-bottom: 15px;
      color: #ccc;
    }

    .controls-section {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .section-title {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      color: #6a11cb;
      font-size: 1.3rem;
      gap: 10px;
    }

    .section-title i {
      font-size: 1.5rem;
    }

    .tabs {
      display: flex;
      border-bottom: 2px solid #eee;
      margin-bottom: 20px;
    }

    .tab-btn {
      padding: 12px 25px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      color: #666;
      position: relative;
      transition: all 0.3s;
    }

    .tab-btn.active {
      color: #2575fc;
      font-weight: 600;
    }

    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background-color: #2575fc;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
    }

    .control-group {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
    }

    .control-group h4 {
      margin-bottom: 15px;
      color: #333;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .control-group h4 i {
      color: #2575fc;
    }

    .slider-container {
      margin: 15px 0;
    }

    .slider-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    input[type="range"] {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #ddd;
      outline: none;
    }

    .value-display {
      font-weight: 600;
      color: #2575fc;
      min-width: 40px;
      text-align: right;
    }

    .filter-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
    }

    .filter-btn {
      padding: 10px;
      border: 2px solid #e0e0e0;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .filter-btn:hover {
      border-color: #2575fc;
      transform: translateY(-2px);
    }

    .filter-btn.active {
      border-color: #2575fc;
      background-color: #f0f5ff;
    }

    .filter-name {
      font-size: 0.9rem;
      margin-top: 5px;
      color: #333;
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 30px;
      justify-content: center;
    }

    .action-btn {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s;
      min-width: 200px;
      justify-content: center;
    }

    .primary-btn {
      background: linear-gradient(to right, #2575fc, #6a11cb);
      color: white;
    }

    .primary-btn:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(37, 117, 252, 0.3);
    }

    .secondary-btn {
      background: #6c757d;
      color: white;
    }

    .secondary-btn:hover {
      background: #5a6268;
      transform: translateY(-5px);
    }

    .action-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
      box-shadow: none !important;
    }

    .notification {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background-color: #28a745;
      color: white;
      padding: 18px 25px;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      display: none;
      z-index: 1000;
      max-width: 350px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #2575fc;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .format-options {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .format-option {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .format-option input {
      margin-right: 5px;
    }

    @media (max-width: 1100px) {
      .main-content {
        flex-direction: column;
      }
      
      .upload-section, .editor-section {
        min-width: 100%;
      }
      
      .controls-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 768px) {
      .controls-grid {
        grid-template-columns: 1fr;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .action-btn {
        width: 100%;
      }
      
      header h1 {
        font-size: 2rem;
      }
    }

    .batch-mode {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .file-list {
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
    }

    .file-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: white;
      margin-bottom: 8px;
      border-radius: 6px;
      border-left: 4px solid #2575fc;
    }

    .file-item .remove-file {
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 4px;
      width: 25px;
      height: 25px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .quality-preset {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preset-btn {
      padding: 8px 15px;
      background: #e9ecef;
      border: 1px solid #ced4da;
      border-radius: 6px;
      cursor: pointer;
    }

    .preset-btn.active {
      background: #2575fc;
      color: white;
      border-color: #2575fc;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-image"></i> Advanced Image to PNG Converter</h1>
      <p>Convert, edit, and enhance images to PNG format with professional editing tools, filters, and batch processing capabilities.</p>
    </header>

    <div class="main-content">
      <div class="upload-section">
        <div class="upload-area" id="upload-area">
          <i class="fas fa-cloud-upload-alt"></i>
          <h3>Upload Your Images</h3>
          <p>Drag & drop or click to select images</p>
          <p>Supports: JPG, JPEG, GIF, BMP, WEBP, TIFF</p>
          <div class="upload-buttons">
            <button class="upload-btn" id="single-upload-btn">
              <i class="fas fa-file-image"></i> Single Image
            </button>
            <button class="upload-btn" id="batch-upload-btn">
              <i class="fas fa-layer-group"></i> Multiple Images
            </button>
          </div>
          <input type="file" id="image-upload" accept="image/*" multiple>
        </div>

        <div class="info-panel">
          <div class="info-item">
            <div class="info-label">
              <i class="fas fa-image"></i>
              <span>Image Format:</span>
            </div>
            <div class="info-value" id="format-info">-</div>
          </div>
          <div class="info-item">
            <div class="info-label">
              <i class="fas fa-expand-alt"></i>
              <span>Dimensions:</span>
            </div>
            <div class="info-value" id="dimensions-info">-</div>
          </div>
          <div class="info-item">
            <div class="info-label">
              <i class="fas fa-weight-hanging"></i>
              <span>File Size:</span>
            </div>
            <div class="info-value" id="size-info">-</div>
          </div>
          <div class="info-item">
            <div class="info-label">
              <i class="fas fa-palette"></i>
              <span>Color Space:</span>
            </div>
            <div class="info-value" id="colorspace-info">-</div>
          </div>
        </div>

        <div class="batch-mode">
          <input type="checkbox" id="batch-mode-checkbox">
          <label for="batch-mode-checkbox">Enable Batch Processing</label>
        </div>

        <div class="file-list" id="file-list" style="display: none;">
          <h4>Selected Files:</h4>
          <!-- Files will be added here dynamically -->
        </div>
      </div>

      <div class="editor-section">
        <div class="preview-container">
          <img id="image-preview" src="" alt="Image Preview">
          <div class="placeholder" id="placeholder">
            <i class="fas fa-image"></i>
            <h3>No Image Loaded</h3>
            <p>Upload an image to start editing and converting to PNG</p>
          </div>
        </div>

        <div class="controls-section">
          <div class="section-title">
            <i class="fas fa-sliders-h"></i>
            <h3>Image Editor & Converter</h3>
          </div>

          <div class="tabs">
            <button class="tab-btn active" data-tab="edit">Edit</button>
            <button class="tab-btn" data-tab="filters">Filters</button>
            <button class="tab-btn" data-tab="convert">Convert</button>
          </div>

          <!-- Edit Tab -->
          <div class="tab-content active" id="edit-tab">
            <div class="controls-grid">
              <div class="control-group">
                <h4><i class="fas fa-crop-alt"></i> Resize</h4>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Width:</span>
                    <span class="value-display" id="width-value">100%</span>
                  </div>
                  <input type="range" id="width-slider" min="10" max="200" value="100" step="1">
                </div>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Height:</span>
                    <span class="value-display" id="height-value">100%</span>
                  </div>
                  <input type="range" id="height-slider" min="10" max="200" value="100" step="1">
                </div>
                <div class="quality-preset">
                  <button class="preset-btn" data-width="50" data-height="50">50%</button>
                  <button class="preset-btn" data-width="75" data-height="75">75%</button>
                  <button class="preset-btn active" data-width="100" data-height="100">100%</button>
                  <button class="preset-btn" data-width="125" data-height="125">125%</button>
                </div>
              </div>

              <div class="control-group">
                <h4><i class="fas fa-adjust"></i> Adjustments</h4>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Brightness:</span>
                    <span class="value-display" id="brightness-value">100%</span>
                  </div>
                  <input type="range" id="brightness-slider" min="0" max="200" value="100" step="1">
                </div>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Contrast:</span>
                    <span class="value-display" id="contrast-value">100%</span>
                  </div>
                  <input type="range" id="contrast-slider" min="0" max="200" value="100" step="1">
                </div>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Saturation:</span>
                    <span class="value-display" id="saturation-value">100%</span>
                  </div>
                  <input type="range" id="saturation-slider" min="0" max="200" value="100" step="1">
                </div>
              </div>

              <div class="control-group">
                <h4><i class="fas fa-sync-alt"></i> Transform</h4>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Rotation:</span>
                    <span class="value-display" id="rotation-value">0°</span>
                  </div>
                  <input type="range" id="rotation-slider" min="-180" max="180" value="0" step="1">
                </div>
                <div style="margin-top: 15px;">
                  <button class="filter-btn" id="flip-horizontal">
                    <i class="fas fa-arrows-alt-h"></i>
                    <div class="filter-name">Flip Horizontal</div>
                  </button>
                  <button class="filter-btn" id="flip-vertical" style="margin-top: 10px;">
                    <i class="fas fa-arrows-alt-v"></i>
                    <div class="filter-name">Flip Vertical</div>
                  </button>
                </div>
              </div>

              <div class="control-group">
                <h4><i class="fas fa-border-style"></i> Effects</h4>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Blur:</span>
                    <span class="value-display" id="blur-value">0px</span>
                  </div>
                  <input type="range" id="blur-slider" min="0" max="20" value="0" step="0.5">
                </div>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Opacity:</span>
                    <span class="value-display" id="opacity-value">100%</span>
                  </div>
                  <input type="range" id="opacity-slider" min="0" max="100" value="100" step="1">
                </div>
                <button class="filter-btn" id="reset-effects" style="margin-top: 15px;">
                  <i class="fas fa-undo"></i>
                  <div class="filter-name">Reset Effects</div>
                </button>
              </div>
            </div>
          </div>

          <!-- Filters Tab -->
          <div class="tab-content" id="filters-tab">
            <div class="controls-grid">
              <div class="control-group">
                <h4><i class="fas fa-sun"></i> Color Filters</h4>
                <div class="filter-buttons">
                  <button class="filter-btn" data-filter="none">
                    <i class="fas fa-ban"></i>
                    <div class="filter-name">None</div>
                  </button>
                  <button class="filter-btn" data-filter="grayscale">
                    <i class="fas fa-moon"></i>
                    <div class="filter-name">Grayscale</div>
                  </button>
                  <button class="filter-btn" data-filter="sepia">
                    <i class="fas fa-umbrella-beach"></i>
                    <div class="filter-name">Sepia</div>
                  </button>
                  <button class="filter-btn" data-filter="invert">
                    <i class="fas fa-adjust"></i>
                    <div class="filter-name">Invert</div>
                  </button>
                  <button class="filter-btn" data-filter="hue-rotate">
                    <i class="fas fa-palette"></i>
                    <div class="filter-name">Hue Rotate</div>
                  </button>
                  <button class="filter-btn" data-filter="saturate">
                    <i class="fas fa-tint"></i>
                    <div class="filter-name">Saturate</div>
                  </button>
                </div>
              </div>

              <div class="control-group">
                <h4><i class="fas fa-bolt"></i> Advanced Filters</h4>
                <div class="filter-buttons">
                  <button class="filter-btn" data-filter="vintage">
                    <i class="fas fa-camera-retro"></i>
                    <div class="filter-name">Vintage</div>
                  </button>
                  <button class="filter-btn" data-filter="cool">
                    <i class="fas fa-snowflake"></i>
                    <div class="filter-name">Cool</div>
                  </button>
                  <button class="filter-btn" data-filter="warm">
                    <i class="fas fa-fire"></i>
                    <div class="filter-name">Warm</div>
                  </button>
                  <button class="filter-btn" data-filter="dramatic">
                    <i class="fas fa-theater-masks"></i>
                    <div class="filter-name">Dramatic</div>
                  </button>
                  <button class="filter-btn" data-filter="pastel">
                    <i class="fas fa-pastafarianism"></i>
                    <div class="filter-name">Pastel</div>
                  </button>
                  <button class="filter-btn" data-filter="high-contrast">
                    <i class="fas fa-sliders-h"></i>
                    <div class="filter-name">High Contrast</div>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Convert Tab -->
          <div class="tab-content" id="convert-tab">
            <div class="controls-grid">
              <div class="control-group">
                <h4><i class="fas fa-cog"></i> PNG Settings</h4>
                <div class="slider-container">
                  <div class="slider-label">
                    <span>Quality:</span>
                    <span class="value-display" id="quality-value">95%</span>
                  </div>
                  <input type="range" id="quality-slider" min="1" max="100" value="95" step="1">
                </div>
                <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                  Higher quality = larger file size
                </p>
                
                <div style="margin-top: 20px;">
                  <h4>Transparency</h4>
                  <div class="format-options">
                    <div class="format-option">
                      <input type="checkbox" id="transparency-checkbox" checked>
                      <label for="transparency-checkbox">Preserve Transparency</label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="control-group">
                <h4><i class="fas fa-file-export"></i> Output Options</h4>
                <div class="format-options">
                  <div class="format-option">
                    <input type="radio" id="format-png" name="format" value="png" checked>
                    <label for="format-png">PNG (Recommended)</label>
                  </div>
                  <div class="format-option">
                    <input type="radio" id="format-webp" name="format" value="webp">
                    <label for="format-webp">WEBP</label>
                  </div>
                </div>
                
                <div style="margin-top: 20px;">
                  <h4>File Naming</h4>
                  <input type="text" id="filename-input" value="converted_image" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-top: 5px;">
                  <p style="font-size: 0.8rem; color: #666; margin-top: 5px;">
                    Use {index} for batch numbering (e.g., image_{index}.png)
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Processing image...</p>
          </div>

          <div class="action-buttons">
            <button class="action-btn primary-btn" id="convert-single-btn" disabled>
              <i class="fas fa-file-download"></i> Convert to PNG
            </button>
            <button class="action-btn secondary-btn" id="convert-batch-btn" disabled>
              <i class="fas fa-layer-group"></i> Convert All (Batch)
            </button>
            <button class="action-btn secondary-btn" id="reset-btn">
              <i class="fas fa-undo"></i> Reset All
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i> Image converted successfully!
  </div>

  <script>
    // DOM Elements
    const uploadArea = document.getElementById('upload-area');
    const imageUpload = document.getElementById('image-upload');
    const singleUploadBtn = document.getElementById('single-upload-btn');
    const batchUploadBtn = document.getElementById('batch-upload-btn');
    const imagePreview = document.getElementById('image-preview');
    const placeholder = document.getElementById('placeholder');
    const convertSingleBtn = document.getElementById('convert-single-btn');
    const convertBatchBtn = document.getElementById('convert-batch-btn');
    const resetBtn = document.getElementById('reset-btn');
    const notification = document.getElementById('notification');
    const loading = document.getElementById('loading');
    const fileList = document.getElementById('file-list');
    const batchModeCheckbox = document.getElementById('batch-mode-checkbox');

    // Info elements
    const formatInfo = document.getElementById('format-info');
    const dimensionsInfo = document.getElementById('dimensions-info');
    const sizeInfo = document.getElementById('size-info');
    const colorspaceInfo = document.getElementById('colorspace-info');

    // Slider elements
    const widthSlider = document.getElementById('width-slider');
    const heightSlider = document.getElementById('height-slider');
    const widthValue = document.getElementById('width-value');
    const heightValue = document.getElementById('height-value');
    const brightnessSlider = document.getElementById('brightness-slider');
    const contrastSlider = document.getElementById('contrast-slider');
    const saturationSlider = document.getElementById('saturation-slider');
    const rotationSlider = document.getElementById('rotation-slider');
    const blurSlider = document.getElementById('blur-slider');
    const opacitySlider = document.getElementById('opacity-slider');
    const qualitySlider = document.getElementById('quality-slider');

    // Value displays
    const brightnessValue = document.getElementById('brightness-value');
    const contrastValue = document.getElementById('contrast-value');
    const saturationValue = document.getElementById('saturation-value');
    const rotationValue = document.getElementById('rotation-value');
    const blurValue = document.getElementById('blur-value');
    const opacityValue = document.getElementById('opacity-value');
    const qualityValue = document.getElementById('quality-value');

    // State variables
    let currentImage = null;
    let originalImage = null;
    let images = [];
    let batchMode = false;
    let currentFilter = 'none';
    let originalWidth = 0;
    let originalHeight = 0;

    // Event Listeners
    uploadArea.addEventListener('click', () => imageUpload.click());
    singleUploadBtn.addEventListener('click', () => {
      imageUpload.removeAttribute('multiple');
      imageUpload.click();
    });
    
    batchUploadBtn.addEventListener('click', () => {
      imageUpload.setAttribute('multiple', 'multiple');
      imageUpload.click();
    });
    
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.style.backgroundColor = '#f0f5ff';
      uploadArea.style.borderColor = '#6a11cb';
    });
    
    uploadArea.addEventListener('dragleave', () => {
      uploadArea.style.backgroundColor = 'white';
      uploadArea.style.borderColor = '#2575fc';
    });
    
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.style.backgroundColor = 'white';
      uploadArea.style.borderColor = '#2575fc';
      
      if (e.dataTransfer.files.length) {
        handleImageUpload(Array.from(e.dataTransfer.files));
      }
    });

    imageUpload.addEventListener('change', (event) => {
      handleImageUpload(Array.from(event.target.files));
    });

    batchModeCheckbox.addEventListener('change', () => {
      batchMode = batchModeCheckbox.checked;
      fileList.style.display = batchMode ? 'block' : 'none';
      convertSingleBtn.disabled = batchMode;
      convertBatchBtn.disabled = !batchMode || images.length === 0;
    });

    // Tab switching
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        this.classList.add('active');
        const tabId = this.getAttribute('data-tab');
        document.getElementById(`${tabId}-tab`).classList.add('active');
      });
    });

    // Slider event listeners
    widthSlider.addEventListener('input', updateImage);
    heightSlider.addEventListener('input', updateImage);
    brightnessSlider.addEventListener('input', updateImage);
    contrastSlider.addEventListener('input', updateImage);
    saturationSlider.addEventListener('input', updateImage);
    rotationSlider.addEventListener('input', updateImage);
    blurSlider.addEventListener('input', updateImage);
    opacitySlider.addEventListener('input', updateImage);
    qualitySlider.addEventListener('input', updateQuality);

    // Update value displays
    widthSlider.addEventListener('input', () => widthValue.textContent = `${widthSlider.value}%`);
    heightSlider.addEventListener('input', () => heightValue.textContent = `${heightSlider.value}%`);
    brightnessSlider.addEventListener('input', () => brightnessValue.textContent = `${brightnessSlider.value}%`);
    contrastSlider.addEventListener('input', () => contrastValue.textContent = `${contrastSlider.value}%`);
    saturationSlider.addEventListener('input', () => saturationValue.textContent = `${saturationSlider.value}%`);
    rotationSlider.addEventListener('input', () => rotationValue.textContent = `${rotationSlider.value}°`);
    blurSlider.addEventListener('input', () => blurValue.textContent = `${blurSlider.value}px`);
    opacitySlider.addEventListener('input', () => opacityValue.textContent = `${opacitySlider.value}%`);
    qualitySlider.addEventListener('input', () => qualityValue.textContent = `${qualitySlider.value}%`);

    // Preset buttons
    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const width = this.getAttribute('data-width');
        const height = this.getAttribute('data-height');
        widthSlider.value = width;
        heightSlider.value = height;
        widthValue.textContent = `${width}%`;
        heightValue.textContent = `${height}%`;
        updateImage();
      });
    });

    // Filter buttons
    document.querySelectorAll('.filter-btn[data-filter]').forEach(btn => {
      btn.addEventListener('click', function() {
        currentFilter = this.getAttribute('data-filter');
        document.querySelectorAll('.filter-btn[data-filter]').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        updateImage();
      });
    });

    // Transform buttons
    document.getElementById('flip-horizontal').addEventListener('click', () => {
      imagePreview.style.transform = `${imagePreview.style.transform} scaleX(-1)`;
    });
    
    document.getElementById('flip-vertical').addEventListener('click', () => {
      imagePreview.style.transform = `${imagePreview.style.transform} scaleY(-1)`;
    });
    
    document.getElementById('reset-effects').addEventListener('click', resetEffects);

    // Action buttons
    convertSingleBtn.addEventListener('click', convertSingleImage);
    convertBatchBtn.addEventListener('click', convertBatchImages);
    resetBtn.addEventListener('click', resetAll);

    // Functions
    function handleImageUpload(files) {
      const validFiles = Array.from(files).filter(file => 
        file.type.startsWith('image/') && !file.type.includes('svg')
      );
      
      if (validFiles.length === 0) {
        showNotification('No valid image files selected', 'error');
        return;
      }
      
      if (batchMode || validFiles.length > 1) {
        // Batch mode
        validFiles.forEach((file, index) => {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            const img = new Image();
            
            img.onload = function() {
              const imageData = {
                id: Date.now() + index,
                name: file.name,
                size: file.size,
                url: e.target.result,
                width: img.width,
                height: img.height,
                type: file.type,
                file: file
              };
              
              images.push(imageData);
              updateFileList();
              
              // Set as current image if it's the first one
              if (images.length === 1) {
                setCurrentImage(imageData);
              }
              
              convertBatchBtn.disabled = false;
            };
            
            img.src = e.target.result;
          };
          
          reader.readAsDataURL(file);
        });
      } else {
        // Single image mode
        const file = validFiles[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
          const img = new Image();
          
          img.onload = function() {
            const imageData = {
              id: Date.now(),
              name: file.name,
              size: file.size,
              url: e.target.result,
              width: img.width,
              height: img.height,
              type: file.type,
              file: file
            };
            
            images = [imageData];
            setCurrentImage(imageData);
            convertSingleBtn.disabled = false;
          };
          
          img.src = e.target.result;
        };
        
        reader.readAsDataURL(file);
      }
      
      // Reset file input
      imageUpload.value = '';
    }

    function setCurrentImage(imageData) {
      currentImage = imageData;
      originalImage = imageData.url;
      
      // Update preview
      imagePreview.src = imageData.url;
      imagePreview.style.display = 'block';
      placeholder.style.display = 'none';
      
      // Update info panel
      formatInfo.textContent = imageData.type.split('/')[1].toUpperCase();
      dimensionsInfo.textContent = `${imageData.width} × ${imageData.height}`;
      sizeInfo.textContent = formatFileSize(imageData.size);
      colorspaceInfo.textContent = 'RGB';
      
      // Store original dimensions
      originalWidth = imageData.width;
      originalHeight = imageData.height;
      
      // Reset sliders
      resetSliders();
      
      // Update image
      updateImage();
    }

    function updateFileList() {
      fileList.innerHTML = '<h4>Selected Files:</h4>';
      
      images.forEach((img, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        fileItem.innerHTML = `
          <div>
            <strong>${img.name}</strong>
            <div style="font-size: 0.8rem; color: #666;">${formatFileSize(img.size)}</div>
          </div>
          <button class="remove-file" onclick="removeImage(${img.id})">
            <i class="fas fa-times"></i>
          </button>
        `;
        fileList.appendChild(fileItem);
      });
    }

    function removeImage(id) {
      images = images.filter(img => img.id !== id);
      updateFileList();
      
      if (currentImage && currentImage.id === id) {
        if (images.length > 0) {
          setCurrentImage(images[0]);
        } else {
          resetPreview();
        }
      }
      
      convertBatchBtn.disabled = images.length === 0;
    }

    function updateImage() {
      if (!currentImage) return;
      
      const width = parseInt(widthSlider.value);
      const height = parseInt(heightSlider.value);
      const brightness = parseInt(brightnessSlider.value);
      const contrast = parseInt(contrastSlider.value);
      const saturation = parseInt(saturationSlider.value);
      const rotation = parseInt(rotationSlider.value);
      const blur = parseFloat(blurSlider.value);
      const opacity = parseInt(opacitySlider.value);
      
      // Apply filters
      let filterValue = '';
      
      switch(currentFilter) {
        case 'grayscale':
          filterValue = 'grayscale(100%)';
          break;
        case 'sepia':
          filterValue = 'sepia(100%)';
          break;
        case 'invert':
          filterValue = 'invert(100%)';
          break;
        case 'hue-rotate':
          filterValue = 'hue-rotate(90deg)';
          break;
        case 'saturate':
          filterValue = 'saturate(200%)';
          break;
        case 'vintage':
          filterValue = 'sepia(70%) brightness(80%) contrast(120%)';
          break;
        case 'cool':
          filterValue = 'sepia(30%) hue-rotate(180deg) brightness(110%)';
          break;
        case 'warm':
          filterValue = 'sepia(50%) hue-rotate(-30deg) saturate(150%)';
          break;
        case 'dramatic':
          filterValue = 'contrast(150%) brightness(80%) saturate(120%)';
          break;
        case 'pastel':
          filterValue = 'saturate(70%) brightness(110%) contrast(90%)';
          break;
        case 'high-contrast':
          filterValue = 'contrast(200%)';
          break;
        default:
          filterValue = 'none';
      }
      
      // Build transform and filter strings
      const transform = `rotate(${rotation}deg)`;
      const filters = `brightness(${brightness}%) contrast(${contrast}%) saturate(${saturation}%) blur(${blur}px) ${filterValue}`;
      
      // Apply styles
      imagePreview.style.transform = transform;
      imagePreview.style.filter = filters;
      imagePreview.style.opacity = `${opacity}%`;
      imagePreview.style.width = `${width}%`;
      imagePreview.style.height = `${height}%`;
      
      // Update dimensions info
      const newWidth = Math.round(originalWidth * (width / 100));
      const newHeight = Math.round(originalHeight * (height / 100));
      dimensionsInfo.textContent = `${newWidth} × ${newHeight}`;
    }

    function updateQuality() {
      qualityValue.textContent = `${qualitySlider.value}%`;
    }

    function resetEffects() {
      brightnessSlider.value = 100;
      contrastSlider.value = 100;
      saturationSlider.value = 100;
      blurSlider.value = 0;
      opacitySlider.value = 100;
      
      brightnessValue.textContent = '100%';
      contrastValue.textContent = '100%';
      saturationValue.textContent = '100%';
      blurValue.textContent = '0px';
      opacityValue.textContent = '100%';
      
      currentFilter = 'none';
      document.querySelectorAll('.filter-btn[data-filter]').forEach(b => b.classList.remove('active'));
      document.querySelector('.filter-btn[data-filter="none"]').classList.add('active');
      
      updateImage();
    }

    function resetSliders() {
      widthSlider.value = 100;
      heightSlider.value = 100;
      brightnessSlider.value = 100;
      contrastSlider.value = 100;
      saturationSlider.value = 100;
      rotationSlider.value = 0;
      blurSlider.value = 0;
      opacitySlider.value = 100;
      qualitySlider.value = 95;
      
      widthValue.textContent = '100%';
      heightValue.textContent = '100%';
      brightnessValue.textContent = '100%';
      contrastValue.textContent = '100%';
      saturationValue.textContent = '100%';
      rotationValue.textContent = '0°';
      blurValue.textContent = '0px';
      opacityValue.textContent = '100%';
      qualityValue.textContent = '95%';
      
      // Reset preset buttons
      document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
      document.querySelector('.preset-btn[data-width="100"]').classList.add('active');
    }

    function resetPreview() {
      imagePreview.src = '';
      imagePreview.style.display = 'none';
      placeholder.style.display = 'flex';
      
      formatInfo.textContent = '-';
      dimensionsInfo.textContent = '-';
      sizeInfo.textContent = '-';
      colorspaceInfo.textContent = '-';
      
      convertSingleBtn.disabled = true;
      convertBatchBtn.disabled = true;
    }

    function resetAll() {
      images = [];
      currentImage = null;
      originalImage = null;
      batchModeCheckbox.checked = false;
      batchMode = false;
      fileList.style.display = 'none';
      fileList.innerHTML = '';
      
      resetEffects();
      resetSliders();
      resetPreview();
      
      showNotification('All settings have been reset', 'info');
    }

    async function convertSingleImage() {
      if (!currentImage) return;
      
      loading.style.display = 'block';
      
      try {
        // Create canvas
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        // Calculate dimensions
        const width = Math.round(originalWidth * (parseInt(widthSlider.value) / 100));
        const height = Math.round(originalHeight * (parseInt(heightSlider.value) / 100));
        
        canvas.width = width;
        canvas.height = height;
        
        // Load image
        const img = new Image();
        img.crossOrigin = 'anonymous';
        
        await new Promise((resolve, reject) => {
          img.onload = resolve;
          img.onerror = reject;
          img.src = originalImage;
        });
        
        // Apply transformations
        ctx.save();
        
        // Apply rotation
        if (parseInt(rotationSlider.value) !== 0) {
          ctx.translate(canvas.width / 2, canvas.height / 2);
          ctx.rotate(parseInt(rotationSlider.value) * Math.PI / 180);
          ctx.translate(-canvas.width / 2, -canvas.height / 2);
        }
        
        // Draw image
        ctx.drawImage(img, 0, 0, width, height);
        ctx.restore();
        
        // Apply filters (simplified - real implementation would be more complex)
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        // Apply brightness, contrast, saturation (simplified)
        applyColorAdjustments(imageData, 
          parseInt(brightnessSlider.value), 
          parseInt(contrastSlider.value), 
          parseInt(saturationSlider.value)
        );
        
        ctx.putImageData(imageData, 0, 0);
        
        // Get filename
        let filename = document.getElementById('filename-input').value;
        if (!filename.toLowerCase().endsWith('.png')) {
          filename += '.png';
        }
        
        // Convert to PNG
        const pngUrl = canvas.toDataURL('image/png', parseInt(qualitySlider.value) / 100);
        
        // Trigger download
        const link = document.createElement('a');
        link.download = filename;
        link.href = pngUrl;
        link.click();
        
        showNotification('Image converted to PNG successfully!', 'success');
        
      } catch (error) {
        console.error('Error converting image:', error);
        showNotification('Error converting image. Please try again.', 'error');
      } finally {
        loading.style.display = 'none';
      }
    }

    async function convertBatchImages() {
      if (images.length === 0) return;
      
      loading.style.display = 'block';
      convertBatchBtn.disabled = true;
      
      try {
        for (let i = 0; i < images.length; i++) {
          const imageData = images[i];
          
          // Create canvas
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          
          // Use original dimensions or apply scaling
          const width = Math.round(imageData.width * (parseInt(widthSlider.value) / 100));
          const height = Math.round(imageData.height * (parseInt(heightSlider.value) / 100));
          
          canvas.width = width;
          canvas.height = height;
          
          // Load image
          const img = new Image();
          img.crossOrigin = 'anonymous';
          
          await new Promise((resolve, reject) => {
            img.onload = resolve;
            img.onerror = reject;
            img.src = imageData.url;
          });
          
          // Draw image
          ctx.drawImage(img, 0, 0, width, height);
          
          // Get filename
          let filename = document.getElementById('filename-input').value;
          if (filename.includes('{index}')) {
            filename = filename.replace('{index}', i + 1);
          } else {
            filename = `${filename}_${i + 1}`;
          }
          
          if (!filename.toLowerCase().endsWith('.png')) {
            filename += '.png';
          }
          
          // Convert to PNG
          const pngUrl = canvas.toDataURL('image/png', parseInt(qualitySlider.value) / 100);
          
          // Trigger download
          const link = document.createElement('a');
          link.download = filename;
          link.href = pngUrl;
          link.click();
          
          // Small delay to avoid overwhelming the browser
          await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        showNotification(`Successfully converted ${images.length} images to PNG!`, 'success');
        
      } catch (error) {
        console.error('Error converting batch images:', error);
        showNotification('Error converting images. Please try again.', 'error');
      } finally {
        loading.style.display = 'none';
        convertBatchBtn.disabled = false;
      }
    }

    function applyColorAdjustments(imageData, brightness, contrast, saturation) {
      const data = imageData.data;
      const brightnessFactor = (brightness - 100) / 100;
      const contrastFactor = (contrast - 100) / 100;
      const saturationFactor = (saturation - 100) / 100;
      
      for (let i = 0; i < data.length; i += 4) {
        let r = data[i];
        let g = data[i + 1];
        let b = data[i + 2];
        
        // Apply brightness
        if (brightnessFactor > 0) {
          r = r + (255 - r) * brightnessFactor;
          g = g + (255 - g) * brightnessFactor;
          b = b + (255 - b) * brightnessFactor;
        } else {
          r = r * (1 + brightnessFactor);
          g = g * (1 + brightnessFactor);
          b = b * (1 + brightnessFactor);
        }
        
        // Apply contrast
        const avg = (r + g + b) / 3;
        r = avg + (r - avg) * (1 + contrastFactor);
        g = avg + (g - avg) * (1 + contrastFactor);
        b = avg + (b - avg) * (1 + contrastFactor);
        
        // Apply saturation (simplified)
        if (saturationFactor !== 0) {
          const gray = 0.2989 * r + 0.5870 * g + 0.1140 * b;
          r = gray + (r - gray) * (1 + saturationFactor);
          g = gray + (g - gray) * (1 + saturationFactor);
          b = gray + (b - gray) * (1 + saturationFactor);
        }
        
        // Clamp values
        data[i] = Math.max(0, Math.min(255, r));
        data[i + 1] = Math.max(0, Math.min(255, g));
        data[i + 2] = Math.max(0, Math.min(255, b));
      }
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' bytes';
      else if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';
      else return (bytes / 1048576).toFixed(2) + ' MB';
    }

    function showNotification(message, type = 'success') {
      // Set notification color based on type
      let bgColor, icon;
      switch(type) {
        case 'success':
          bgColor = '#28a745';
          icon = 'fa-check-circle';
          break;
        case 'error':
          bgColor = '#dc3545';
          icon = 'fa-exclamation-circle';
          break;
        case 'warning':
          bgColor = '#ffc107';
          icon = 'fa-exclamation-triangle';
          break;
        case 'info':
          bgColor = '#17a2b8';
          icon = 'fa-info-circle';
          break;
        default:
          bgColor = '#28a745';
          icon = 'fa-check-circle';
      }
      
      notification.innerHTML = `<i class="fas ${icon}"></i> ${message}`;
      notification.style.backgroundColor = bgColor;
      notification.style.display = 'block';
      
      // Auto hide after 4 seconds
      setTimeout(() => {
        notification.style.display = 'none';
      }, 4000);
    }
  </script>
</body>
</html>